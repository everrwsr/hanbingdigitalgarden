---
{"dg-publish":true,"permalink":"/许鑫艺毕设/","dgPassFrontmatter":true}
---

基于多特征提取的恶意软件分类器设计

设计并实现一个基于多特征提取的恶意软件分类器。
通过提取恶意软件样本的特征，能够自动将其分类为不同的恶意软件家族。使用合适的机器学习算法，如支持向量机（SVM）或随机森林，训练分类器并进行模型评估。

## Microsoft Malware Detection - log loss of 0.0070
代码地址

[Microsoft Malware Detection - log loss of 0.0070 | Kaggle](https://www.kaggle.com/code/paulrohan2020/microsoft-malware-detection-log-loss-of-0-0070/notebook)
这个内核有什么


数据描述


我为这个大数据集遇到的问题


我处理这个庞大数据集的最终总体方法


数据概述


性能指标


机器学习目标和约束


探索性数据分析


整个数据集中恶意软件类的分布


字节文件的文件大小作为功能


文件大小（.byte文件）功能的框图


从字节文件中提取uni-gram字节功能


字节文件的多元分析


火车测试拆分仅字节文件功能


仅在字节文件上随机模型


K最近的邻居分类仅在字节文件上


仅在字节文件上进行逻辑回归


仅在字节文件上随机森林分类器


仅在字节文件上进行XGBoost分类


XGBOOST分类与最佳超级参数仅使用随机搜索仅在字节文件上


使用.ASM文件建模


从ASM文件提取功能


每个.ASM文件作为功能的文件大小


仅对.ASM文件功能的单变量分析


仅在.ASM文件功能上进行多元分析


结论EDA（仅在.ASM文件功能上）


训练和测试拆分（仅在.ASM文件功能上）


k-nearest Neigbors仅在.asm文件功能上


仅在.ASM文件功能上进行逻辑回归


仅在.ASM文件功能上随机森林分类器


仅在.ASM文件功能上XGBoost分类器


XGBoost分类器具有最佳的超参数（仅在.ASM文件功能上）


最终XGBoost模型培训的最终功能步骤


从字节文件中提取uni -gram字节功能 - 用于最终模型火车


字节文件的文件大小 - 功能提取 - 最终模型列车


创建一些重要的文件和文件夹，稍后我将用于保存.csv文件的功能版本


合并字节文件的UMIGRAM +字节文件的大小以创建uni_gram_byte_features__with_size


从字节文件中提取Bi-gram字节特征


使用selectkest和Chi-square Test从字节bigrams中提取2000个最重要的功能


ASM Unigram-来自ASM文件的前52个Unigram功能 - 最终模型培训


ASM文件的文件大小 - 功能提取 - 最终模型培训


合并ASM Umigram + ASM文件大小


ASM文件 - 将ASM文件转换为图像


从ASM文件图像中提取第一个800像素数据


从ASM文件中提取opcodes bigrams


Colcualte opcodes bigram具有上述函数并使其成为功能，然后将功能的数据矩阵保存为.csv文件


ASM文件 -  opcodes bigrams的最重要的500个功能


opcodes trigrams asm文件 - 功能提取


SM文件 -  opcodes Trigrams的最重要的800个功能


最终XGBoost培训的所有功能的最终合并


最终火车测试拆分。64％的火车，16％的交叉验证，20％的测试


最终XGBOOST训练 - 与最终合并的数据 - 矩阵进行超参数调整


XGBoost的最终运行以及我们从上面的随机搜索获得的最佳hyperparams


进一步分析和特征的可能性










## 使用多输入模型进行恶意软件分类的动态数据融合


可以尝试运行试试的


使用文件 hexParsingCode.py 和 textParsingCode.py 转换了数据。运行文件 classifyingTextNUMBERS.py、classifyingTextMULTI.py 和 classifyingTextENSEMBLE.py 以创建模型。该文件 classifyingFunctions.py 包含支持功能。
犯罪分子使用恶意软件来破坏网络系统。随着车辆、路由器和灯泡等常见系统成为日益互联的网络系统，这些易受恶意软件攻击的系统的数量正在迅速增加。为了解决这个问题的规模，分析师将恶意软件分为几类，并为每个类别开发专门的防御措施。在这个项目中，我们用机器学习对恶意软件进行了分类。特别是，我们使用了监督多类长短期记忆（LSTM）模型。我们用数千个带有类标签（训练集）注释的恶意软件文件来训练算法，并且算法学习了指示每个类的模式。我们使用了反汇编的恶意软件文件（由 Microsoft 提供），并将组成数据分离为解析指令（看起来像人类可读的机器代码文本）和原始字节（十六进制值）。我们感兴趣的是哪种格式（文本或十六进制）作为分类的输入更有价值。为了解决这个问题，我们研究了四种情况：纯文本模型、纯十六进制模型、同时使用文本和十六进制输入的多输入模型，以及基于组合单个结果的模型。我们使用机器学习 Python 包 Keras 进行了这项调查，该包允许轻松配置深度学习架构和训练。我们希望了解不同格式之间的权衡。由于数据中的类不平衡，我们使用了多种方法来比较格式，使用测试精度、平衡精度（考虑类的权重）和从混淆表得出的准确性。我们发现，允许同时学习两种输入类型的多输入模型产生了最佳性能。 我们的发现通过为研究人员提供合适的深度学习架构来训练针对其恶意软件的定制版本，从而加快了恶意软件分类研究。
论文地址
[Dynamic data fusion using multi-input models for malware classification | Papers With Code](https://paperswithcode.com/paper/dynamic-data-fusion-using-multi-input-models)
代码地址
[GitHub - viktorZenkov/MalwareClassification: Malware classification machine learning code for investigation reproducibility.](https://github.com/viktorZenkov/MalwareClassification)




## Microsoft Malware Classification


[GitHub - czs108/Microsoft-Malware-Classification: 🔍 "2015 Microsoft Malware Classification Challenge" - Using machine learning to classify malware into different families based on Windows PE structures, disassembly scripts and machine code.](https://github.com/czs108/microsoft-malware-classification)

使用的特征

|Item 项目|Description 描述|
|:-:|:-:|
|File Size 文件大小|The sizes of disassembly and machine code files, and their ratios.  <br>反汇编文件和机器代码文件的大小及其比率。|
|API 4-gram API 4 克|API sequences. API 序列。|
|Opcode 4-gram 操作码 4-gram|Opcode sequences. 操作码序列。|
|Import Library 导入库|Import libraries in the PE Import Table.  <br>在 PE 导入表中导入库。|
|PE Section Size PE截面尺寸|The virtual sizes and raw sizes of PE sections, and their ratios.  <br>PE 截面的虚拟尺寸和原始尺寸及其比率。|
|PE Section Permission PE部分权限|The total sizes of readable data, writable data and executable code.  <br>可读数据、可写数据和可执行代码的总大小。|
|Content Complexity 内容复杂性|The original sizes, compressed sizes and compression ratios of disassembly and machine code files.  <br>反汇编文件和机器代码文件的原始大小、压缩大小和压缩比。|
模型

These models have been tested in the project:  
这些模型已在项目中进行了测试：

- _Support Vector 支持向量_
- _K-Nearest Neighbors K-最近邻_
- _Random Forest 随机森林_






## Malware-Classification-Using-Static-Disassembly-and-Machine-Learning

代码地址
[GitHub - WahajJaved20/Malware-Classification-Using-Static-Disassembly-and-Machine-Learning](https://github.com/WahajJaved20/Malware-Classification-Using-Static-Disassembly-and-Machine-Learning)
有文档






##  Microsoft Malware Detection
代码地址
[GitHub - PrasunDutta007/Microsoft-Malware-Detection-Analysis: Reducing the Errors in Malware Prediction using Machine Learning Techniques](https://github.com/PrasunDutta007/Microsoft-Malware-Detection-Analysis)
readme很详细



## 一种新的特征提取、选择和融合，用于有效的恶意软件家族分类
9年前的代码

[Microsoft-Malware-Challenge/Source Code at master · ManSoSec/Microsoft-Malware-Challenge · GitHub](https://github.com/ManSoSec/Microsoft-Malware-Challenge/tree/master/Source%20Code)
论文
[(PDF) Novel Feature Extraction, Selection and Fusion for Effective Malware Family Classification](https://www.researchgate.net/publication/283986464_Novel_Feature_Extraction_Selection_and_Fusion_for_Effective_Malware_Family_Classification)

















[Novel Feature Extraction, Selection and Fusion for Effective Malware Family Classification | Papers With Code](https://paperswithcode.com/paper/novel-feature-extraction-selection-and-fusion)











综述

[基于AI的恶意软件分析技术（3）\_pe 文件, 软件检测 , svm-CSDN博客](https://blog.csdn.net/qq_41701054/article/details/124584074?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170505235216800225530001%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=170505235216800225530001&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-7-124584074-null-null.142^v99^pc_search_result_base8&utm_term=%E5%9F%BA%E4%BA%8E%E5%A4%9A%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96%E7%9A%84%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E5%88%86%E7%B1%BB%E5%99%A8%E8%AE%BE%E8%AE%A1&spm=1018.2226.3001.4187)



深度学习图片

[Python实现基于卷积神经网络的恶意代码分类系统.zip\_CNN恶意代码类型的训练集获取资源-CSDN文库](https://download.csdn.net/download/sheziqiong/88324878)




其他代码

[GitHub - bitterzzZZ/Bert-malware-classification: 使用Bert做embedding，结合BiLSTM做恶意软件的多分类任务](https://github.com/bitterzzZZ/Bert-malware-classification)

[GitHub - ocatak/malware\_api\_class: Malware dataset for security researchers, data scientists. Public malware dataset generated by Cuckoo Sandbox based on Windows OS API calls analysis for cyber security researchers](https://github.com/ocatak/malware_api_class)

